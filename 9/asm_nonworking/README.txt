This doesn't work due to an overflow in nCr, and I can't be bothered fixing it right now.
Need 64-bit arithmetic throughout this function.
